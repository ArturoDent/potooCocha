"use strict";function prepareSVGstyles(e){var t;t=e.target&&"SAMsvg"===e.target.id?document.getElementById("SAMsvg"):document.getElementById(e);var a=t.contentDocument;for(var n in countries){var s=a.getElementById(n);s&&setSVGstyles(s,baseColor,baseStrokeColor)}}function setSVGstyles(e){if("path"===e.nodeName)e.style.transition="fill 1s";else if("g"===e.parentNode.nodeName)for(var t=e.querySelectorAll("path"),a=t.length,n=0;n<a;n++)t[n].style.transition="fill 1s"}function fillSAMmap(e){e||(e=baseColor);var t;t=currentMap.querySelector("#SAMsvg");var a=t.contentDocument;for(var n in countries){var s=a.getElementById(n);s&&newFillColor(s,e)}addBirdNameToMap("")}function newFillColor(e,t){if("path"===e.nodeName)t===baseColor&&(e.style.fill="#757570"),e.style.fill=t;else if("g"===e.parentNode.nodeName)for(var a=e.querySelectorAll("path"),n=a.length,s=0;s<n;s++)t===baseColor&&(a[s].style.fill="#757570"),a[s].style.fill=t}function selectedCountryFillColor(e,t){var a=currentMap.querySelector("#SAMsvg"),n=a.contentDocument,s=n.getElementById(e);s?(fillSAMmap(),newFillColor(s,t)):fillSAMmap()}function highlightSAMmap(e,t){var a;a="currentMap"===t?currentMap.querySelector("#SAMsvg"):document.getElementById(t);var n=a.contentDocument,s=birds[e].split("-");for(var l in countries){var r=n.getElementById(l);if(r)switch(s[countries[l]]){case"X(e)":newFillColor(r,endemicColor);break;case"X":newFillColor(r,residentColor);break;case"NB":newFillColor(r,nonBreederColor);break;case"V":newFillColor(r,vagrantColor);break;case"H":newFillColor(r,hypotheticalColor);break;case"IN":newFillColor(r,introducedColor);break;case"EX":newFillColor(r,extinctColor);break;case"EX(e)":newFillColor(r,extinctColor);break;default:newFillColor(r,baseColor)}}"currentMap"===t&&mapsCollection.children.length<5&&(saveMapButton.style.display="block")}function initMapFactory(){saveMapButton=document.querySelector(".saveMapButton"),saveMapButton.addEventListener("click",saveCurrentMap)}function deleteMap(){var e=this.parentNode;e.addEventListener("transitionend",e.parentNode.removeChild(this.parentNode),!1),e.classList.add("removed"),map.querySelector(".saveMapButton").style.display="block";var t=mapsCollection.children.length;0===t&&(mapsCollection.style.height="0",mapsCollection.style.margin="0")}function saveCurrentMap(){var e=mapsCollection.children.length;if(5!==e){var t=map.children[0],a=t.cloneNode(!0);a.classList.remove("birdMapInstance"),a.classList.add("thinify"),a.classList.add("smallBird"),a.querySelector(".birdName").classList.add("smallBirdText"),a.querySelector(".colorKey").style.opacity="0",a.querySelector(".colorKey").style.display="none",a.querySelector(".birdName").removeAttribute("id"),a.querySelector(".drawing").removeAttribute("id"),a.querySelector(".drawing").classList.add("smallBirdDrawing"),a.querySelector(".drawing").firstElementChild.setAttribute("id","thin"+currentID),a.removeAttribute("id"),0===e?(mapsCollection.style.height="300px",mapsCollection.style.margin="30px 0 -35px 0"):e>=4&&(map.querySelector(".saveMapButton").style.display="none"),mapsCollection.appendChild(a),deleteMapButton=a.querySelector(".deleteMapButton"),deleteMapButton.addEventListener("click",deleteMap),document.getElementById("thin"+currentID).onload=function(){prepareSVGstyles("thin"+currentID),highlightSAMmap(lastIndex,"thin"+currentID),mapsCollection.lastChild.style.opacity="1",currentID++}}}function onResizeWindow(){setFooterBannerDimensions(),initCurrentMap()}function initCurrentMap(){prepareSVGstyles("SAMsvg"),map||(map=document.getElementById("currentMap")),map.style.opacity="1"}function setFooterBannerDimensions(){var e=document.body.getBoundingClientRect().left,t=e;if(document.documentElement.clientWidth<=1024)return void(document.getElementsByClassName("articles")[0].style.left=-(.8*e)+"px");document.getElementsByClassName("articles")[0].style.left=-(.7*e)+"px",t=.7*e;var a=.35*e,n=document.documentElement.clientWidth;footer.style.left=-e+"px",footer.style.width=n-a+"px",titleBanner.style.left=-e+"px";var s=document.getElementsByClassName("titleText")[0];s.style.left=.31*t-s.getBoundingClientRect().width+1+"px",titleBanner.style.width=.3*t+"px",mapsCollection.style.left=-e+"px",mapsCollection.style.width=n+"px"}function showCountryModal(e){document.querySelector("#countryModal").classList.add("md-show"),document.querySelector("#mainContent").classList.add("modal-shrink"),map.classList.add("modal-shrink"),countryModalOpener="checklistCountryButton"===e.target.id?"checklistCountryButton":"taxonomyCountryButton"}function closeCountryModal(){document.querySelector("#countryModal").classList.remove("md-show"),document.querySelector("#mainContent").classList.remove("modal-shrink"),map.classList.remove("modal-shrink")}function toggleSampleTableShowEndemics(){sampleTable.querySelector("td.endemical").classList.toggle("showEndemics")}function toggleSampleTableSciNames(){sampleTable.classList.toggle("noScientificNames"),italics.disabled=!italics.disabled}function toggleSampleTableItalics(){sampleTable.classList.toggle("noItalics")}function toggleSampleTableLeftChecks(){[].forEach.call(sampleTable.getElementsByClassName("leftCheckBox"),function(e){e.classList.toggle("show")}),[].forEach.call(sampleTable.getElementsByClassName("familyHidden"),function(e){e.classList.toggle("show")})}function toggleSampleTableLineNumbers(){sampleTable.querySelector("td.lineNumbers").classList.toggle("showLineNumbers")}function choseCountry(e){"checklistCountryButton"===countryModalOpener?choseChecklistCountry(e):loadCountryTaxonomy(e)}function choseChecklistCountry(e){var t=document.body.scrollTop;closeCountryModal();var a=e.target.innerHTML;currentChecklistCountry&&(currentChecklistCountryElement.classList.remove("checkHighlight"),currentChecklistCountryElement.classList.remove("bothHighlights")),currentChecklistCountry="South America"===a?"SouthAmerica":"French Guiana"===a?"FrenchGuiana":"Malvinas"===a?"Falklands":"Malvinas"===a?"Falklands":"Curaçao"===a?"Curacao":a,checklistCountryButton.innerHTML=a,currentChecklistCountryElement=e.target,currentChecklistCountryElement.classList.add("checkHighlight"),currentChecklistCountryElement.classList.contains("taxHighlight")&&currentChecklistCountryElement.classList.add("bothHighlights");var n=document.getElementById("checklistCountryButton").getBoundingClientRect().width;document.getElementById("checklistCountryButton").style.right=-n/2-20+"px",checklistCountryButton.classList.remove("needsAttention"),checklistCountryButton.classList.add("highlight"),pdfButton.classList.add("highlight"),csvButton.classList.add("highlight"),document.body.scrollTop=t,currentMap.querySelector(".saveMapButton").style.display="none",currentMap.querySelector(".colorKey").style.opacity="0",selectedCountryFillColor(currentChecklistCountry,selectedFillColor)}function setNumDays(e){var t=e.target;t.classList.contains("highlight")||((gNumDays||0===gNumDays)&&numDaysButton.children[gNumDays+1].classList.remove("highlight"),t.classList.add("highlight"),gNumDays=parseInt(t.innerHTML),sampleTable.classList.remove(previousNumDaysClass),sampleTable.classList.add("numDays"+String(gNumDays)),previousNumDaysClass="numDays"+String(gNumDays),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(6)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(4)").classList.remove("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.remove("cds"),6===gNumDays||7===gNumDays?([].forEach.call(sampleTable.querySelectorAll("td:nth-child(6)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(4)").classList.add("cds")):10===gNumDays?([].forEach.call(sampleTable.querySelectorAll("td:nth-child(13)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(11)").classList.remove("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.add("cds")):5!==gNumDays&&([].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.add("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(13)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(11)").classList.add("cds")),0!==gNumDays&&([].forEach.call(sampleTable.getElementsByTagName("th"),function(e){e.classList.remove("flashDays")}),sampleTable.querySelector("th:nth-child("+(gNumDays+1)+")").classList.add("flashDays")))}function getCSVText(){if(currentChecklistCountry){var e=document.createElement("form");e.setAttribute("method","post"),e.setAttribute("action","../php/sendCSV.php?country="+currentChecklistCountry),document.body.appendChild(e),e.submit(),e.remove()}else checklistCountryButton.classList.add("needsAttention")}function openChecklistPage(){var e;return currentChecklistCountry?(void 0===gNumDays&&(gNumDays=12),void 0===gStartDate&&(gStartDate=1),e="?country="+currentChecklistCountry,e+="&num_days="+gNumDays,e+="&start_date="+gStartDate,e+="&line_nos="+lineNumbers.checked,e+="&left_check="+leftCheck.checked,e+="&endemics="+showEndemics.checked,e+="&sci_names="+!sciNames.checked,e+="&italics="+!italics.checked,void window.open("../php/makePDF.php"+e,"_blank")):(checklistCountryButton.innerHTML="Select Country",void checklistCountryButton.classList.add("needsAttention"))}function loadIntoArray(e){birds=e.split("\n")}function animateScrollTop(e){var t=25;!function a(){e.scrollTop-=t,e.scrollTop>0&&setTimeout(a,25)}()}function getAjax(e,t){var a=new XMLHttpRequest;return a.open("GET",e),a.onreadystatechange=function(){a.readyState>3&&200===a.status&&t(a.responseText)},a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(),a}function showSearchInstructions(e){e!==!0&&searchInstructionsOpen?(searchSlideUpWrapper.style.height=0,searchSlideUpWrapper.style.borderWidth=0,searchSlideUpWrapper.classList.add("closeInstructions"),searchInstructionsOpen=!1,document.querySelector(".taxInstructionsButton .tooltip").innerHTML="Open the search instructions"):(searchSlideUpWrapper.style.height=searchSlideUpWrapper_height,searchSlideUpWrapper.style.borderWidth="2px",searchSlideUpWrapper.classList.remove("closeInstructions"),searchInstructionsOpen=!0,document.querySelector(".taxInstructionsButton .tooltip").innerHTML="Close the search instructions")}function createTaxPageHTML(){resultsFrag="<div class='panel results-panel'>",resultsFrag+="  <div id='countrySearch' class='closed'>",resultsFrag+="    <span id='searchTerm'></span>",resultsFrag+="  </div>",resultsFrag+="  <ul id='searchResults' contenteditable='false'><li> &nbsp; &nbsp; search results will appear here...</li><li></li><li></li></ul>",resultsFrag+="</div>",taxFragHTML="<article id='taxTreeArticle'>",taxFragHTML+="  <div id='treeIntroText'>&nbsp; numFamilies Families, numSpecies species</div>",taxFragHTML+="  <div id='taxPage' class='panel' contenteditable='false'></div>",taxFragHTML+="  <div id='taxPageButtons'>Close all families</div>",taxFragHTML+="</article>"}function loadCountryTaxonomy(e){window.closeCountryModal(),document.getElementById("taxPage")||(taxonomyArticle.insertAdjacentHTML("beforeend",resultsFrag),mapsCollection.insertAdjacentHTML("afterend",taxFragHTML),document.querySelector("#searchForm").style.borderBottom="1px solid black",taxPage=document.getElementById("taxPage"),searchResults=document.getElementById("searchResults"),taxPage.addEventListener("click",toggleFamilyOpen),searchResults.addEventListener("click",gotoMatch),document.querySelector("#searchForm span").classList.remove("grayed"),searchSpecials.classList.remove("grayed"));var t="string"==typeof e?e:e.target.innerHTML;if(currentTaxonomyCountry&&(currentTaxonomyCountryElement.classList.remove("taxHighlight"),currentTaxonomyCountryElement.classList.remove("bothHighlights")),lastQuery&&(document.getElementById("countrySearch").classList.remove("closed"),document.getElementById("searchTerm").innerHTML=t+" : '"+lastQuery,document.querySelector(".results-panel").style.opacity="1"),"French Guiana"===t?(getAjax("Countries/FrenchGuianaSACC.html",function(e){updatetaxArticleQueries(e)}),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")):"Curaçao"===t?(getAjax("Countries/CuracaoSACC.html",function(e){updatetaxArticleQueries(e)}),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")):"South America"===t?(getAjax("Countries/SouthAmericaSACC.html",function(e){updatetaxArticleQueries(e)}),searchResults.classList.add("samTax"),searchSpecials.querySelector("span:nth-of-type(3)").classList.add("notAvailable"),searchSpecials.querySelector("span:nth-of-type(5)").classList.add("notAvailable"),searchSpecials.classList.add("SAM"),taxPage.classList.add("samTax")):"Malvinas"===t?(getAjax("Countries/FalklandsSACC.html",function(e){updatetaxArticleQueries(e)}),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")):t&&(getAjax("Countries/"+t+"SACC.html",function(e){updatetaxArticleQueries(e)}),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")),"South America"===currentTaxonomyCountry&&"South America"!==t&&(searchSpecials.querySelector("span:nth-of-type(3)").classList.remove("notAvailable"),searchSpecials.querySelector("span:nth-of-type(5)").classList.remove("notAvailable"),searchSpecials.classList.remove("SAM")),lastQuery)"endemic"!==lastQuery&&"hypothetical"!==lastQuery&&"vagrant"!==lastQuery&&"incertae"!==lastQuery&&"extinct"!==lastQuery||(currentMap.querySelector(".saveMapButton").style.display="none",selectedCountryFillColor(t.replace(" ",""),selectedFillColor));else{currentMap.querySelector(".saveMapButton").style.display="none";var a=t.replace(" ","");selectedCountryFillColor(a,selectedFillColor)}currentTaxonomyCountry=t,taxonomyCountryButton.innerHTML=t,currentTaxonomyCountryElement=e.target,currentTaxonomyCountryElement.classList.add("taxHighlight"),currentTaxonomyCountryElement.classList.contains("checkHighlight")&&currentTaxonomyCountryElement.classList.add("bothHighlights"),taxonomyCountryButton.classList.remove("needsAttention"),taxonomyCountryButton.classList.add("highlight"),document.querySelector("#treeIntroText").innerHTML=t+" &nbsp; : &nbsp; "+numFamiliesList[t]+" families, "+numSpeciesList[t]+" species *",document.querySelector(".colorKey").style.opacity="0.9",animateScrollTop(taxPage)}function updatetaxArticleQueries(e){taxPage.innerHTML=e,species=document.getElementById("tree").getElementsByTagName("li"),families=document.getElementById("tree").getElementsByClassName("family"),numFamilies=families.length,lastQuery&&searchTree(lastQuery),document.querySelector("#taxPageButtons").addEventListener("click",closeAllFamilies)}function clearSearchInput(){searchInput.placeholder="",searchInput.removeEventListener("input",clearSearchInput),searchInput.removeEventListener("change",clearSearchInput),searchInput.removeEventListener("click",clearSearchInput),searchInput.removeEventListener("textInput",clearSearchInput),searchInput.removeEventListener("focusin",clearSearchInput)}function getQuery(e){var t=searchInput.value.search(/[^a-zñã'\s\*\?-]/i);if(t!==-1)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; character '"+searchInput.value[t]+"' not allowed </li><li></li>",void(searchResults.style.height="55px");if(!(searchInput.value.length<2)){var a=e||window.event;return"textinput"===a.type?(searchTree(searchInput.value),a.preventDefault(),!1):void("input"===a.type?searchTree(searchInput.value):"onpropertychange"===a.type&&searchTree(searchInput.value))}}function getSearchSpecialsQuery(e){var t=e.target.textContent.split(" ")[0];searchTree(t)}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function searchTree(e){var t;e=escapeRegExp(e),document.querySelector(".colorKey").style.opacity="0.9";var a=0,n=new MutationObserver(function(){searchResults.style.height="auto",searchResults.scrollHeight>=300?searchResults.style.height="300px":searchResults.style.height=searchResults.scrollHeight+"px"});if(n.observe(searchResults,{childList:!0}),!currentTaxonomyCountry)return void taxonomyCountryButton.classList.add("needsAttention");if(document.getElementById("searchResults").classList.remove("fadeIn"),document.querySelector(".results-panel").style.opacity="1",lastQuery=e,!lastQuery)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; search results will appear here</li><li></li>",searchResults.classList.add("fadeIn"),void(searchResults.style.top=0);document.getElementById("countrySearch").classList.remove("closed"),document.getElementById("searchTerm").innerHTML=currentTaxonomyCountry+" : '"+lastQuery,animateScrollTop(searchResults);for(var s=0;s<numFamilies;s++)families[s].cloned=!1;var l=!1;lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active");var r,c,o=[],i=0,u=species.length;if("endemic"===e||"hypothetical"===e||"vagrant"===e||"incertae"===e||"extinct"===e){var d;"endemic"===e?d=document.getElementById("tree").getElementsByClassName("endemic"):"extinct"===e?d=document.getElementById("tree").getElementsByClassName("extinct"):"hypothetical"===e?d=document.getElementById("tree").getElementsByClassName("hy"):"vagrant"===e?d=document.getElementById("tree").getElementsByClassName("va"):"incertae"===e&&(d=document.getElementById("tree").getElementsByClassName("ince"));for(var m=0;m<d.length;m++)d[m].parentNode.parentNode.parentNode.cloned!==!0&&(o[i++]=d[m].parentNode.parentNode.parentNode.cloneNode(!0),d[m].parentNode.parentNode.parentNode.cloned=!0),o[i++]=d[m].parentNode.cloneNode(!0)}else{if(e=e.replace(/^\s+|\s+$/g,""),e=e.replace(/\\\*/g,"[a-zA-Z'ñã\\s-]+"),e=e.replace(/\\\?/g,"[a-zA-Z'ñã\\s-]"),e=e.replace(/n/g,"(n|ñ)"),e=e.replace(/a/g,"(a|ã)"),e=e.replace(/ú/g,"u"),e=e.replace(/á/g,"a"),e=e.replace(/ó/g,"o"),e=e.replace(/í/g,"i"),e=e.replace(/ç/g,"c"),e=e.replace(/\s+/g,"\\s+"),e?t=e:(t=searchInput.value.replace(/^\s+|\s+$/g,""),"type here"===t?l=!0:""===t&&(l=!0)),l)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; no search term entered</li><li></li>",document.getElementById("searchResults").classList.add("fadeIn"),void(searchResults.style.height="55px");var p=new RegExp(t,"i");for(s=0;s<u;s++)if(r=species[s],c=r.className,r.firstChild.textContent.match(p)||r.childNodes[1].textContent.match(p)){"family"!==c&&"familyOpen"!==c||(r.cloned=!0);var h=r.parentNode.parentNode;"family"!==c&&"familyOpen"!==c&&h.cloned!==!0&&(o[i++]=h.cloneNode(!0),h.cloned=!0),o[i++]=r.cloneNode(!0)}}if(0===o.length)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; no matching results found</li><li></li>",document.getElementById("searchResults").classList.add("fadeIn"),void(searchResults.style.height="55px");var y,g,f="";for(m=0;m<o.length;m++)if(g=o[m].className,"family"===g||"familyOpen"===g){if(f+="<li class='family'><span class='fco'>",f+=o[m].firstChild.textContent+"</span><span class='fsc'>",f+=o[m].childNodes[1].firstChild?o[m].childNodes[1].firstChild.nodeValue:" ",f+="</span></li>",1===o.length){for(y=0;y<o[0].children[2].children.length;y++)f+="<li>"+o[0].children[2].children[y].innerHTML+"</li>";a=y}}else"fsc"===g||(o[m].style.textShadow="none",f+="<li data-i='"+o[m].getAttribute("data-i")+"' class='bird'>"+o[m].innerHTML+"</li>",a++);searchResults.innerHTML=f,document.getElementById("searchResults").classList.add("fadeIn"),lastQuery=lastQuery.replace(/\\\*/g,"*"),lastQuery=lastQuery.replace(/\\\?/g,"?"),document.getElementById("searchTerm").innerHTML=currentTaxonomyCountry+" : '"+lastQuery+"'&nbsp;&nbsp;&nbsp;   [ "+a+" species ]"}function gotoMatch(e){document.querySelector(".colorKey").style.opacity="0.9",lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active");var t=e||window.event,a=t.target,n=a.parentNode,s=a.className;if("no matching results found"!==a.textContent.replace(/^\s+|\s+$/g,"")&&"no search term entered"!==a.textContent.replace(/^\s+|\s+$/g,"")&&"search results will appear here"!==a.textContent.replace(/^\s+|\s+$/g,"")&&""!==a.textContent.replace(/^\s+|\s+$/g,"")){a="family"===s?t.target:"fco"===s?n:"fsc"===s?n:null!==s.match(/co/)?n:"bird"===s?t.target:n;for(var l,r=species.length,c=a.textContent,o=0;o<r;o++){if(l=species[o],l.textContent===c){var i=l.parentNode;i.classList.contains("open")||(i.classList.add("open"),i.parentNode.className="familyOpen"),taxPage.scrollTop=i.parentNode.offsetTop+l.offsetTop-100,l.className="active",lastSpecies=l,lastIndex=Number(l.getAttribute("data-i")),highlightSAMmap(lastIndex,"currentMap"),lastResultsSpecies&&lastResultsSpecies.classList.toggle("active"),a.classList.toggle("active"),lastResultsSpecies=a,addBirdNameToMap(l);break}if(l.firstChild.textContent+l.firstChild.nextSibling.textContent===c||c===l.firstChild.textContent+" "){var u=l.children[2];u.classList.contains("closed")&&(u.classList.add("open"),u.parentNode.className="familyOpen"),taxPage.scrollTop=l.offsetTop-10,lastSpecies=u,lastResultsSpecies&&(lastResultsSpecies.classList.toggle("active"),lastResultsSpecies=null);break}}}}function addBirdNameToMap(e){var t="";e?(t="<span>"+e.firstChild.textContent+"</span><br/><span>"+e.lastChild.textContent+"</span>",document.getElementById("currentBirdName").innerHTML=t):document.getElementById("currentBirdName").innerHTML=t}function toggleFamilyOpen(e){if(e.stopPropagation(),numFamilies){document.querySelector(".colorKey").style.opacity="0.9",e=e||window.event;var t,a=e.target,n=a.className;if("family"===n||"familyOpen"===n?t=e.target.firstChild.nextSibling.nextSibling.nextSibling:"fco"===n?t=e.target.nextSibling.nextSibling.nextSibling:"fsc"===n&&(t=e.target.nextSibling.nextSibling),t&&!t.classList.contains("open")){t.classList.add("open"),t.parentNode.className="familyOpen";var s=taxPage.getBoundingClientRect().height;t.offsetTop-taxPage.scrollTop>s-24&&(t.parentNode.clientHeight>s?taxPage.scrollTop=t.parentNode.offsetTop:taxPage.scrollTop+=t.lastElementChild.offsetTop+t.lastElementChild.clientHeight),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"  &nbsp; : &nbsp; "+t.parentNode.children[1].textContent+" has "+t.children.length+" species"}else if(t){t.classList.remove("open"),t.parentNode.className="family";var l=t.parentNode.querySelectorAll(".active");l.length&&(l[0].className=""),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : &nbsp; "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species"}t||(a.parentNode.classList.contains("birds")&&(a=a.firstChild),a.parentNode.className="active",lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active"),lastSpecies=a.parentNode,lastResultsSpecies&&lastResultsSpecies.classList.toggle("active"),lastResultsSpecies=null,addBirdNameToMap(a.parentNode),lastIndex=Number(a.parentNode.getAttribute("data-i")),highlightSAMmap(lastIndex,"currentMap"),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : &nbsp; "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species *")}}function closeAllFamilies(){for(var e=taxPage.querySelectorAll("#tree .familyOpen ul"),t=e.length,a=0;a<t;a++)e[a].classList.remove("open"),e[a].classList.add("closed"),e[a].parentNode.className="family";document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species *"}var countries={Argentina:0,Aruba:1,Bolivia:2,Brazil:3,Chile:4,Colombia:5,Curacao:6,Ecuador:7,FrenchGuiana:8,Guyana:9,Paraguay:10,Peru:11,Suriname:12,Trinidad:13,Uruguay:14,Venezuela:15,Bonaire:16,Falklands:17},endemicColor="#C23BC3",extinctColor="#ddd",residentColor="#3030cc",nonBreederColor="#ff9900",vagrantColor="#ffff00",hypotheticalColor="#33cc66",introducedColor="#111",baseColor="#404448",baseStrokeColor="#333",deleteMapButton,saveMapButton,currentID=0;!function(e,t){function a(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function n(e){var t=h[e[m]];return t||(t={},p++,e[m]=p,h[p]=t),t}function s(e,a,s){return a||(a=t),o?a.createElement(e):(s||(s=n(a)),a=s.cache[e]?s.cache[e].cloneNode():d.test(e)?(s.cache[e]=s.createElem(e)).cloneNode():s.createElem(e),a.canHaveChildren&&!u.test(e)?s.frag.appendChild(a):a)}function l(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(a){return y.shivMethods?s(a,e,t):t.createElem(a)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+a().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function r(e){e||(e=t);var a=n(e);if(y.shivCSS&&!c&&!a.hasCSS){var s,r=e;s=r.createElement("p"),r=r.getElementsByTagName("head")[0]||r.documentElement,s.innerHTML="x<style>article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}</style>",s=r.insertBefore(s.lastChild,r.firstChild),a.hasCSS=!!s}return o||l(e,a),e}var c,o,i=e.html5||{},u=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,d=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",p=0,h={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",c="hidden"in e;var a;if(!(a=1==e.childNodes.length)){t.createElement("a");var n=t.createDocumentFragment();a="undefined"==typeof n.cloneNode||"undefined"==typeof n.createDocumentFragment||"undefined"==typeof n.createElement}o=a}catch(e){o=c=!0}}();var y={elements:i.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",version:"3.6.2pre",shivCSS:!1!==i.shivCSS,supportsUnknownElements:o,shivMethods:!1!==i.shivMethods,type:"default",shivDocument:r,createElement:s,createDocumentFragment:function(e,s){if(e||(e=t),o)return e.createDocumentFragment();for(var s=s||n(e),l=s.frag.cloneNode(),r=0,c=a(),i=c.length;r<i;r++)l.createElement(c[r]);return l}};e.html5=y,r(t)}(this,document);var sampleTable,leftCheck,sciNames,italics,lineNumbers,showEndemics,titleBanner,footer,currentChecklistCountry,currentChecklistCountryElement,countryModalOverlay,countryModalOpener,gNumDays,gStartDate,previousNumDaysClass,numDaysButton,checklistCountryButton,pdfButton,csvButton,taxonomyCountryButton,map,mapsCollection;document.addEventListener("DOMContentLoaded",function(){titleBanner=document.getElementById("bigBanner"),footer=document.getElementsByTagName("footer")[0],map=document.getElementById("currentMap"),mapsCollection=document.querySelector("#mapsCollection"),setFooterBannerDimensions(),window.addEventListener("resize",onResizeWindow),countryModalOverlay=document.querySelector(".md-overlay"),countryModalOverlay.addEventListener("click",closeCountryModal),document.getElementById("countryModal").addEventListener("click",closeCountryModal),checklistCountryButton=document.getElementById("checklistCountryButton"),taxonomyCountryButton=document.getElementById("taxonomyCountryButton"),checklistCountryButton.addEventListener("click",showCountryModal),taxonomyCountryButton.addEventListener("click",showCountryModal),numDaysButton=document.getElementById("numDays"),numDaysButton.addEventListener("click",setNumDays),numDaysButton.children.item(11).classList.add("highlight"),gNumDays=10,sampleTable=document.getElementById("sampleTable"),sampleTable.classList.add("numDays"+String(gNumDays)),previousNumDaysClass="numDays"+String(gNumDays),pdfButton=document.getElementById("pdfButton"),pdfButton.addEventListener("click",openChecklistPage),csvButton=document.getElementById("csvButton"),csvButton.addEventListener("click",getCSVText),lineNumbers=document.getElementById("lineNumbers"),leftCheck=document.getElementById("leftCheck"),showEndemics=document.getElementById("showEndemics"),sciNames=document.getElementById("sciNames"),italics=document.getElementById("italics"),previousNumDaysClass="numDays10",lineNumbers.addEventListener("click",toggleSampleTableLineNumbers),leftCheck.addEventListener("click",toggleSampleTableLeftChecks),showEndemics.addEventListener("click",toggleSampleTableShowEndemics),sciNames.addEventListener("click",toggleSampleTableSciNames),italics.addEventListener("click",toggleSampleTableItalics),[].forEach.call(document.getElementsByClassName("country-menu")[0].getElementsByTagName("a"),function(e){e.addEventListener("click",choseCountry)}),initMapFactory()});var lastQuery,lastSpecies,species,families,numFamilies,birds=[],numSpeciesList={Argentina:999,Aruba:216,Bolivia:1381,Brazil:1799,Chile:475,Colombia:1838,"Curaçao":218,Ecuador:1620,"French Guiana":665,Guyana:783,Paraguay:694,Peru:1780,Suriname:724,Trinidad:468,Uruguay:444,Venezuela:1382,Bonaire:210,Falklands:227,Malvinas:227,"South America":3371},numFamiliesList={Argentina:87,Aruba:50,Bolivia:78,Brazil:91,Chile:65,Colombia:90,"Curaçao":50,Ecuador:91,"French Guiana":81,Guyana:78,Paraguay:72,Peru:88,Suriname:80,Trinidad:70,Uruguay:72,Venezuela:87,Bonaire:47,Falklands:48,Malvinas:48,"South America":102},currentTaxonomyCountry,currentTaxonomyCountryElement,taxonomyArticle,resultsFrag="",taxFragHTML="",taxPage,searchSpecials,searchResults,searchInput,lastResultsSpecies,lastIndex,searchSlideUpWrapper,searchSlideUpWrapper_height,searchInstructionsInfo,searchInstructionsOpen=!0,selectedFillColor="#eee";document.addEventListener("DOMContentLoaded",function(){taxonomyArticle=document.getElementById("taxonomyArticle"),searchSlideUpWrapper=document.querySelector("#taxonomyArticle > div.slideUpWrapper"),searchSlideUpWrapper.style.height=searchSlideUpWrapper.clientHeight+"px",searchSlideUpWrapper_height=searchSlideUpWrapper.style.height,searchInstructionsInfo=document.querySelector(".taxInstructionsButton"),searchInput=document.getElementById("searchInput"),searchSpecials=document.getElementById("searchSpecials"),searchInput.addEventListener("input",getQuery),searchInput.addEventListener("change",getQuery),searchInput.addEventListener("click",getQuery),searchInput.addEventListener("textInput",getQuery),searchInput.addEventListener("focusin",getQuery),searchInput.addEventListener("input",clearSearchInput),searchInput.addEventListener("change",clearSearchInput),searchInput.addEventListener("click",clearSearchInput),searchInput.addEventListener("textInput",clearSearchInput),searchInput.addEventListener("keyup",clearSearchInput),searchInput.addEventListener("focusin",clearSearchInput),searchSpecials.addEventListener("click",getSearchSpecialsQuery),searchInstructionsInfo.addEventListener("click",showSearchInstructions),createTaxPageHTML(),getAjax("../data/occurrences.txt",function(e){loadIntoArray(e)})});