"use strict";function onResizeWindow(){window.innerWidth<870?window.addEventListener("scroll",checkWindowScroll):window.removeEventListener("scroll",checkWindowScroll);var e=document.querySelector("#mapsCollection");e.children.length>0&&(window.innerWidth>1680?e.style.height="350px":window.innerWidth>=1600?e.style.height="300px":window.innerWidth>=1165?e.style.height="270px":e.style.height="235px")}function checkWindowScroll(){var e=document.documentElement,t=window;e.scrollHeight-t.innerHeight<=t.pageYOffset?document.getElementById("currentMap").style.opacity=0:document.getElementById("currentMap").style.opacity=1}function initCurrentMap(){prepareSVGstyles("SAMsvg"),map||(map=document.getElementById("currentMap")),map.style.opacity="1"}function showCountryModal(e){countryModal.classList.add("menu-show"),countryModal.classList.add("md-show"),map.classList.add("modal-left"),countryModalOpener="checklistCountryButton"===e.target.id?"checklistCountryButton":"taxonomyCountryButton"}function closeCountryModal(e){countryModal.classList.remove("menu-show"),countryModal.classList.remove("md-show"),map.classList.remove("modal-left"),e&&e.stopPropagation()}function toggleSampleTableShowEndemics(){sampleTable.querySelector("td.endemical").classList.toggle("showEndemics")}function toggleSampleTableSciNames(){sampleTable.classList.toggle("noScientificNames"),italics.disabled=!italics.disabled}function toggleSampleTableItalics(){sampleTable.classList.toggle("noItalics")}function toggleSampleTableLeftChecks(){[].forEach.call(sampleTable.getElementsByClassName("leftCheckBox"),function(e){e.classList.toggle("show")}),[].forEach.call(sampleTable.getElementsByClassName("familyHidden"),function(e){e.classList.toggle("show")})}function toggleSampleTableLineNumbers(){sampleTable.querySelector("td.lineNumbers").classList.toggle("showLineNumbers")}function choseCountry(e){currentChecklistCountry||parseInt||map.getElementsByClassName("drawing")[0].classList.add("active"),"checklistCountryButton"===countryModalOpener?choseChecklistCountry(e):loadCountryTaxonomy(e)}function choseChecklistCountry(e){var t,a=document.body.scrollTop;closeCountryModal(),currentChecklistCountry&&(currentChecklistCountryElement.classList.remove("checkHighlight"),currentChecklistCountryElement.classList.remove("bothHighlights")),"A"===e.target.tagName?(currentChecklistCountryElement=e.target,t=e.target.children[1].innerHTML):"SPAN"===e.target.tagName?(currentChecklistCountryElement=e.target.parentNode,t=e.target.innerHTML):(currentChecklistCountryElement=e.target.parentNode,t=e.target.nextElementSibling.innerHTML),currentChecklistCountry="South America"===t?"SouthAmerica":"French Guiana"===t?"FrenchGuiana":"CuraÃ§ao"===t?"Curacao":t,checklistCountryButton.innerHTML=t,currentChecklistCountryElement.classList.add("checkHighlight"),currentChecklistCountryElement.classList.contains("taxHighlight")&&currentChecklistCountryElement.classList.add("bothHighlights"),checklistCountryButton.classList.remove("needsAttention"),checklistCountryButton.classList.add("highlight"),pdfButton.classList.add("highlight"),csvButton.classList.add("highlight"),document.body.scrollTop=a,currentMap.querySelector(".saveMapButton").style.display="none",currentMap.querySelector(".colorKey").style.opacity="0","South America"!==t?selectedCountryFillColor(currentChecklistCountry,selectedFillColor):fillSAMmap("",""),getAjax("Authors/"+currentChecklistCountry+".txt",setChecklistAuthors)}function setChecklistAuthors(e){if("SouthAmerica"===currentChecklistCountry)return checklistAuthorsPanel.innerHTML="&nbsp;&nbsp;c<a href='citations.html' target='_blank'>itation</a>s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",void checklistAuthorsPanel.classList.add("show");var t=e.replace(/^(.*\.) \d\d\d\d\..*Version(.*$)/g,"$1 $2");checklistAuthorsPanel.innerHTML=t,checklistAuthorsPanel.classList.add("show")}function setNumDays(e){var t=e.target;t.classList.contains("highlight")||((gNumDays||0===gNumDays)&&numDaysButton.children[gNumDays+1].classList.remove("highlight"),t.classList.add("highlight"),gNumDays=parseInt(t.innerHTML),sampleTable.classList.remove(previousNumDaysClass),sampleTable.classList.add("numDays"+String(gNumDays)),previousNumDaysClass="numDays"+String(gNumDays),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(6)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(4)").classList.remove("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.remove("cds"),6===gNumDays||7===gNumDays?([].forEach.call(sampleTable.querySelectorAll("td:nth-child(6)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(4)").classList.add("cds")):10===gNumDays?([].forEach.call(sampleTable.querySelectorAll("td:nth-child(13)"),function(e){e.classList.remove("cds")}),sampleTable.querySelector("th:nth-child(11)").classList.remove("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.add("cds")):5!==gNumDays&&([].forEach.call(sampleTable.querySelectorAll("td:nth-child(8)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(6)").classList.add("cds"),[].forEach.call(sampleTable.querySelectorAll("td:nth-child(13)"),function(e){e.classList.add("cds")}),sampleTable.querySelector("th:nth-child(11)").classList.add("cds")),0!==gNumDays&&([].forEach.call(sampleTable.getElementsByTagName("th"),function(e){e.classList.remove("flashDays")}),sampleTable.querySelector("th:nth-child("+(gNumDays+1)+")").classList.add("flashDays")))}function getCSVText(){if(currentChecklistCountry){var e=document.createElement("form");e.setAttribute("method","post"),e.setAttribute("action","../php/sendCSV.php?country="+currentChecklistCountry),document.body.appendChild(e),e.submit(),e.remove()}else checklistCountryButton.classList.add("needsAttention")}function openChecklistPage(){var e;if(!currentChecklistCountry)return checklistCountryButton.innerHTML="Select Country",void checklistCountryButton.classList.add("needsAttention");void 0===gNumDays&&(gNumDays=12),void 0===gStartDate&&(gStartDate=1),e="?country="+currentChecklistCountry,e+="&num_days="+gNumDays,e+="&start_date="+gStartDate,e+="&line_nos="+lineNumbers.checked,e+="&left_check="+leftCheck.checked,e+="&endemics="+showEndemics.checked,e+="&sci_names="+!sciNames.checked,e+="&italics="+!italics.checked,window.open("../php/makePDF.php"+e,"_blank")}function prepareSVGstyles(e){var t,a=(t=e.target&&"SAMsvg"===e.target.id?document.getElementById("SAMsvg"):document.getElementById(e)).contentDocument;for(var s in countries){var n=a.getElementById(s);n&&setSVGstyles(n,baseColor,baseStrokeColor)}}function setSVGstyles(e,t,a){if("path"===e.nodeName||"circle"===e.nodeName)e.style.transition="fill 1s";else if("g"===e.parentNode.nodeName)for(var s=e.querySelectorAll("path"),n=s.length,l=0;l<n;l++)s[l].style.transition="fill 1s"}function fillSAMmap(e,t){e||(e=baseColor);var a,s=(a=currentMap.querySelector("#SAMsvg")).contentDocument;for(var n in countries){var l=s.getElementById(n);l&&l!==t&&(newFillColor(l,e),newStrokeColor(l,baseStrokeColor))}addBirdNameToMap("")}function newFillColor(e,t){if("path"===e.nodeName||"circle"===e.nodeName)t===baseColor&&(e.style.fill="#5e5e5e"),e.style.fill=t;else if("g"===e.parentNode.nodeName)for(var a=e.querySelectorAll("path"),s=a.length,n=0;n<s;n++)t===baseColor&&(a[n].style.fill="#5e5e5e"),a[n].style.fill=t}function selectedCountryFillColor(e,t){var a=currentMap.querySelector("#SAMsvg").contentDocument.getElementById(e);fillSAMmap(baseColor,a),newFillColor(a,t),newStrokeColor(a,baseStrokeColor)}function newStrokeColor(e,t){if("path"===e.nodeName||"circle"===e.nodeName)e.style.stroke=t;else if("g"===e.parentNode.nodeName)for(var a=e.querySelectorAll("path"),s=a.length,n=0;n<s;n++)a[n].style.stroke=t}function selectedCountryStrokeColor(e,t){var a=currentMap.querySelector("#SAMsvg").contentDocument.getElementById(e);a&&newStrokeColor(a,t)}function highlightSAMmap(e,t){var a,s=(a="currentMap"===t?currentMap.querySelector("#SAMsvg"):document.getElementById(t)).contentDocument,n=birds[e].split("-");for(var l in countries){var r=s.getElementById(l);if(r){switch("Falklands"===l&&(n[countries[l]]=n[countries[l]].trim()),n[countries[l]]){case"X(e)":newFillColor(r,endemicColor);break;case"X":newFillColor(r,residentColor);break;case"NB":newFillColor(r,nonBreederColor);break;case"V":newFillColor(r,vagrantColor);break;case"H":newFillColor(r,hypotheticalColor);break;case"IN":newFillColor(r,introducedColor);break;case"EX":case"EX(e)":newFillColor(r,extinctColor);break;default:newFillColor(r,baseColor)}"currentMap"!==t&&newStrokeColor(r,"#fff")}}"currentMap"===t&&mapsCollection.children.length<5&&(saveMapButton.style.display="block")}function loadIntoArray(e){birds=e.split("\n")}function animateScrollTop(e){!function t(){e.scrollTop-=25,e.scrollTop>0&&setTimeout(t,25)}()}function getAjax(e,t){var a=new XMLHttpRequest;return a.open("GET",e),a.onreadystatechange=function(){a.readyState>3&&200===a.status&&t(a.responseText)},a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(),a}function showSearchInstructions(e){!0!==e&&searchInstructionsOpen?(searchSlideUpWrapper.classList.add("closeInstructions"),taxInstructionsButton.classList.add("instructionsClosed"),searchSpecials.classList.remove("open"),searchInstructionsOpen=!1,document.querySelector(".taxInstructionsButton .tooltip").innerHTML="Open"):(searchSlideUpWrapper.classList.remove("closeInstructions"),searchSpecials.classList.add("open"),searchInstructionsOpen=!0,document.querySelector(".taxInstructionsButton .tooltip").innerHTML="Close")}function loadCountryTaxonomy(e){var t;if(window.closeCountryModal(),searchSpecials.classList.contains("grayed")&&(document.querySelector("#searchForm span.grayed").classList.remove("grayed"),searchSpecials.classList.remove("grayed")),currentTaxonomyCountry&&(currentTaxonomyCountryElement.classList.remove("taxHighlight"),currentTaxonomyCountryElement.classList.remove("bothHighlights")),"A"===e.target.tagName?(currentTaxonomyCountryElement=e.target,t=e.target.children[1].innerHTML):"SPAN"===e.target.tagName?(currentTaxonomyCountryElement=e.target.parentNode,t=e.target.innerHTML):(currentTaxonomyCountryElement=e.target.parentNode,t=e.target.nextElementSibling.innerHTML),lastQuery&&(document.getElementById("countrySearch").classList.remove("closed"),document.getElementById("searchTerm").innerHTML=t+" : '"+lastQuery+"'",document.querySelector(".results-panel").style.opacity="1"),"French Guiana"===t?(getAjax("Countries/FrenchGuianaSACC.html",updatetaxArticleQueries),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")):"CuraÃ§ao"===t?(getAjax("Countries/CuracaoSACC.html",updatetaxArticleQueries),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")):"South America"===t?(getAjax("Countries/SouthAmericaSACC.html",updatetaxArticleQueries),searchResults.classList.add("samTax"),searchSpecials.querySelector("span:nth-of-type(3)").classList.add("notAvailable"),searchSpecials.querySelector("span:nth-of-type(5)").classList.add("notAvailable"),searchSpecials.classList.add("SAM"),taxPage.classList.add("samTax")):t&&(getAjax("Countries/"+t+"SACC.html",updatetaxArticleQueries),searchResults.classList.remove("samTax"),taxPage.classList.remove("samTax")),"South America"===currentTaxonomyCountry&&"South America"!==t&&(searchSpecials.querySelector("span:nth-of-type(3)").classList.remove("notAvailable"),searchSpecials.querySelector("span:nth-of-type(5)").classList.remove("notAvailable"),searchSpecials.classList.remove("SAM")),lastQuery)"endemic"!==lastQuery&&"hypothetical"!==lastQuery&&"vagrant"!==lastQuery&&"incertae"!==lastQuery&&"extinct"!==lastQuery||(currentMap.querySelector(".saveMapButton").style.display="none","South America"!==t&&selectedCountryFillColor(t.replace(" ",""),selectedFillColor));else{currentMap.querySelector(".saveMapButton").style.display="none";var a=t.replace(" ","");"South America"!==t?selectedCountryFillColor(a,selectedFillColor):fillSAMmap("","")}currentTaxonomyCountry=t,taxonomyCountryButton.innerHTML=t,"Falklands"===t&&(taxonomyCountryButton.innerHTML="Malvinas"),currentTaxonomyCountryElement.classList.add("taxHighlight"),currentTaxonomyCountryElement.classList.contains("checkHighlight")&&currentTaxonomyCountryElement.classList.add("bothHighlights"),taxonomyCountryButton.classList.remove("needsAttention"),taxonomyCountryButton.classList.add("highlight"),document.querySelector("#treeIntroText").innerHTML=t+" &nbsp; : &nbsp; "+numFamiliesList[t]+" families, "+numSpeciesList[t]+" species *","Falklands"===t&&(document.querySelector("#treeIntroText").innerHTML="Falklands/Malvinas &nbsp; : &nbsp; "+numFamiliesList[t]+" families, "+numSpeciesList[t]+" species *"),document.querySelector(".colorKey").style.opacity="0.9",animateScrollTop(taxPage)}function updatetaxArticleQueries(e){taxPage.innerHTML=e;var t=document.getElementById("taxTreeArticle");taxTreeArticleOpen?taxTreeArticleOpen=!0:t.classList.add("expand"),species=document.getElementById("tree").getElementsByTagName("li"),families=taxPage.querySelectorAll("#tree .familyOpen, #tree .family"),numFamilies=families.length,lastQuery&&searchTree(lastQuery),document.querySelector("#taxPageButtons").addEventListener("click",closeAllFamilies),(simpleBarTaxPage=new SimpleBar(document.getElementById("taxPage"),{autoHide:!1})).recalculate()}function clearSearchInput(){searchInput.placeholder="",searchInput.removeEventListener("input",clearSearchInput),searchInput.removeEventListener("change",clearSearchInput),searchInput.removeEventListener("click",clearSearchInput),searchInput.removeEventListener("textInput",clearSearchInput),searchInput.removeEventListener("focusin",clearSearchInput)}function getQuery(e){var t=searchInput.value.search(/[^a-zÃ±Ã£'\s\*\?-]/i);if(-1!==t)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; character '"+searchInput.value[t]+"' not allowed </li><li></li>",searchResults.classList.add("fadeIn"),document.querySelector(".results-panel").classList.add("translateDown"),void resetSearchResultsHeight();if(!(searchInput.value.length<2)){var a=e||window.event;if("textinput"===a.type)return searchTree(searchInput.value),a.preventDefault(),!1;"input"===a.type?searchTree(searchInput.value):"onpropertychange"===a.type&&searchTree(searchInput.value)}}function getSearchSpecialsQuery(e){searchTree(e.target.parentNode.textContent)}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function searchTree(e){var t;e=escapeRegExp(e),document.querySelector(".colorKey").style.opacity="0.9";var a=0;if(currentTaxonomyCountry){if(document.getElementById("searchResults").classList.remove("fadeIn"),document.querySelector(".results-panel").classList.add("translateDown"),!(lastQuery=e))return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; search results will appear here</li><li></li>",searchResults.classList.add("fadeIn"),searchResults.style.top=0,void resetSearchResultsHeight();document.getElementById("countrySearch").classList.remove("closed"),document.getElementById("searchTerm").innerHTML="Falklands"===currentTaxonomyCountry?"Falklands/Malvinas : '"+lastQuery+"'":currentTaxonomyCountry+" : '"+lastQuery+"'",animateScrollTop(searchResults);for(var s=0;s<numFamilies;s++)families[s].cloned=!1;var n=!1;lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active");var l,r,o=[],c=0,i=species.length;if("endemic"===e||"hypothetical"===e||"vagrant"===e||"incertae"===e||"extinct"===e){var u;"endemic"===e?u=document.getElementById("tree").getElementsByClassName("endemic"):"extinct"===e?u=document.getElementById("tree").getElementsByClassName("extinct"):"hypothetical"===e?u=document.getElementById("tree").getElementsByClassName("hy"):"vagrant"===e?u=document.getElementById("tree").getElementsByClassName("va"):"incertae"===e&&(u=document.getElementById("tree").getElementsByClassName("ince"));for(var d=0;d<u.length;d++)!0!==u[d].parentNode.parentNode.parentNode.cloned&&(o[c++]=u[d].parentNode.parentNode.parentNode.cloneNode(!0),u[d].parentNode.parentNode.parentNode.cloned=!0),o[c++]=u[d].parentNode.cloneNode(!0)}else{if(e=e.replace(/^\s+|\s+$/g,""),e=e.replace(/n/g,"(n|Ã±)"),e=e.replace(/a/g,"(a|Ã£)"),e=e.replace(/Ãº/g,"u"),e=e.replace(/Ã¡/g,"a"),e=e.replace(/Ã³/g,"o"),e=e.replace(/Ã­/g,"i"),e=e.replace(/Ã§/g,"c"),e=e.replace(/\s+/g,"\\s+"),e?t=e:"type here"===(t=searchInput.value.replace(/^\s+|\s+$/g,""))?n=!0:""===t&&(n=!0),n)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; no search term entered</li><li></li>",document.getElementById("searchResults").classList.add("fadeIn"),void resetSearchResultsHeight();var m=new RegExp(t,"i");for(s=0;s<i;s++)if(l=species[s],r=l.className,l.firstChild.textContent.match(m)||l.childNodes[1].textContent.match(m)){"family"!==r&&"familyOpen"!==r||(l.cloned=!0);var p=l.parentNode.parentNode;"family"!==r&&"familyOpen"!==r&&!0!==p.cloned&&(o[c++]=p.cloneNode(!0),p.cloned=!0),o[c++]=l.cloneNode(!0)}}if(0===o.length)return searchResults.innerHTML="<li></li><li> &nbsp; &nbsp; no matching results found</li><li></li>",document.getElementById("searchResults").classList.add("fadeIn"),void resetSearchResultsHeight();var h,y,g="";for(d=0;d<o.length;d++)if("family"===(y=o[d].className)||"familyOpen"===y){if(g+="<li class='family'><span class='fco'>",g+=o[d].firstChild.firstChild.textContent+"</span><span class='fsc'>",g+=o[d].firstChild.lastChild?o[d].firstChild.childNodes[1].textContent:" ",g+="</span></li>",1===o.length){for(h=0;h<o[0].children[1].children.length;h++)g+="<li>"+o[0].children[1].children[h].innerHTML+"</li>";a=h}}else"fsc"===y||(o[d].style.textShadow="none",g+="<li data-i='"+o[d].getAttribute("data-i")+"' class='bird'>"+o[d].innerHTML+"</li>",a++);searchResults.innerHTML=g,document.getElementById("searchResults").classList.add("fadeIn"),lastQuery=lastQuery.replace(/\\\*/g,"*"),lastQuery=lastQuery.replace(/\\\?/g,"?"),document.getElementById("searchTerm").innerHTML="Falklands"===currentTaxonomyCountry?"Malvinas/Falklands : '"+lastQuery+"'&nbsp;&nbsp;&nbsp;   [ "+a+" species ]":currentTaxonomyCountry+" : '"+lastQuery+"'&nbsp;&nbsp;&nbsp;   [ "+a+" species ]",resetSearchResultsHeight()}else taxonomyCountryButton.classList.add("needsAttention")}function resetSearchResultsHeight(){searchResults.style.height="auto",(simpleBarResults=new SimpleBar(document.getElementById("searchResults"),{autoHide:!1})).recalculate();searchResults.scrollHeight>=300?(searchResults.style.height="325px",simpleBarResults.getScrollElement().style.maxHeight="320px"):(searchResults.style.height=searchResults.scrollHeight+35+"px",simpleBarResults.getScrollElement().style.height=searchResults.scrollHeight+35+"px"),simpleBarResults.recalculate()}function gotoMatch(e){currentMap.querySelector(".colorKey").style.opacity="0.9",lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active");var t=e||window.event,a=t.target,s=a.parentNode,n=a.className;if(-1===a.className.indexOf("simplebar")&&-1===a.className.indexOf("fadeIn")&&"no matching results found"!==a.textContent.replace(/^\s+|\s+$/g,"")&&"no search term entered"!==a.textContent.replace(/^\s+|\s+$/g,"")&&"search results will appear here"!==a.textContent.replace(/^\s+|\s+$/g,"")&&""!==a.textContent.replace(/^\s+|\s+$/g,"")){"family"===n?a=t.target:"fco"===n?(a=s,n="family"):"fsc"===n?(a=s,n="family"):a=null!==n.match(/co/)?s:"bird"===n?t.target:s;for(var l,r=species.length,o=a.textContent,c=0;c<r;c++){var i=(l=species[c]).textContent.split("\n")[0];if(i===o&&"family"!==n){var u=l.parentNode;u.classList.contains("open")||(u.classList.add("open"),u.parentNode.className="familyOpen"),simpleBarTaxPage.getScrollElement().scrollTop=u.parentNode.offsetTop+l.offsetTop-100,l.className="active",lastSpecies=l,highlightSAMmap(lastIndex=Number(l.getAttribute("data-i")),"currentMap"),lastResultsSpecies&&lastResultsSpecies.classList.toggle("active"),a.classList.toggle("active"),lastResultsSpecies=a,addBirdNameToMap(l);break}if(i===o&&"family"===n){simpleBarTaxPage.getScrollElement().scrollTop=l.offsetTop,(lastSpecies=l.firstChild).classList.toggle("active"),lastResultsSpecies&&(lastResultsSpecies.classList.toggle("active"),lastResultsSpecies=null);break}}}}function addBirdNameToMap(e){var t="";e?(t="<span>"+e.firstChild.textContent+"</span><br/><span>"+e.lastChild.textContent+"</span>",document.getElementById("currentBirdName").innerHTML=t):document.getElementById("currentBirdName").innerHTML=t}function toggleFamilyOpen(e){if(-1===e.target.className.indexOf("simplebar")&&"taxPage"!==e.target.id&&numFamilies){document.querySelector(".colorKey").style.opacity="0.9";var t,a=(e=e||window.event).target,s=a.className;if("family"===s||"familyOpen"===s?t=e.target.childNodes[1].nextSibling:"fco"===s?t=e.target.parentNode.nextSibling.nextSibling:"fsc"===s?t=e.target.parentNode.nextSibling.nextSibling:"fTitle"!==s&&"fTitle active"!==s||(t=e.target.nextSibling.nextSibling),t&&!t.classList.contains("open")){t.classList.add("open"),t.parentNode.className="familyOpen";var n=taxPage.getBoundingClientRect().height;t.offsetTop-taxPage.scrollTop>n-24&&(t.parentNode.clientHeight>n?taxPage.scrollTop=t.parentNode.offsetTop:taxPage.scrollTop+=t.lastElementChild.offsetTop+t.lastElementChild.clientHeight),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"  &nbsp; : &nbsp; "+t.parentNode.firstChild.children[1].textContent+" has "+t.children.length+" species"}else if(t){t.classList.remove("open"),t.parentNode.className="family";var l=t.parentNode.querySelectorAll(".active");l.length&&l[0].classList.remove("active"),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : &nbsp; "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species"}t||(a.parentNode.classList.contains("birds")&&(a=a.firstChild),a.parentNode.className="active",a.parentNode!==lastSpecies&&lastSpecies&&lastSpecies.classList.contains("active")&&lastSpecies.classList.remove("active"),lastSpecies=a.parentNode,lastResultsSpecies&&lastResultsSpecies.classList.toggle("active"),lastResultsSpecies=null,addBirdNameToMap(a.parentNode),highlightSAMmap(lastIndex=Number(a.parentNode.getAttribute("data-i")),"currentMap"),document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : &nbsp; "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species *"),taxPage.style.zIndex=5}}function closeAllFamilies(){for(var e=taxPage.querySelectorAll("#tree .familyOpen ul"),t=e.length,a=0;a<t;a++)e[a].classList.remove("open"),e[a].classList.add("closed"),e[a].parentNode.className="family";document.querySelector("#treeIntroText").innerHTML=currentTaxonomyCountry+"   &nbsp; : "+numFamiliesList[currentTaxonomyCountry]+" families, "+numSpeciesList[currentTaxonomyCountry]+" species *"}function revealMapsCollection(e){mapsCollection.classList.toggle("open"),map.classList.toggle("shiftUp")}function deleteMap(e){e.stopPropagation(),this.parentNode.parentNode.removeChild(this.parentNode),map.querySelector(".saveMapButton").style.display="block",0===mapsCollection.getElementsByClassName("thinify smallBird").length&&(mapsCollection.classList.remove("namesOnlySeen"),mapsCollection.removeEventListener("click",revealMapsCollection),deleteAllMapsButton.removeEventListener("click",deleteAllMaps),mapsCollection.classList.remove("open"),map.classList.remove("shiftUp"))}function saveCurrentMap(){var e=mapsCollection.getElementsByClassName("thinify smallBird").length;if(5!==e){var t=map.children[0].cloneNode(!0);t.classList.remove("birdMapInstance"),t.classList.add("thinify"),t.classList.add("smallBird"),t.querySelector(".birdName").classList.add("smallBirdText"),t.querySelector(".colorKey").style.opacity="0",t.querySelector(".colorKey").style.display="none",t.querySelector(".birdName").removeAttribute("id"),t.querySelector(".drawing").removeAttribute("id"),t.querySelector(".drawing").classList.add("smallBirdDrawing"),t.querySelector(".drawing").firstElementChild.setAttribute("id","thin"+currentID),t.removeAttribute("id"),0===e?(mapsCollection.addEventListener("click",revealMapsCollection),mapsCollection.classList.add("namesOnlySeen"),(deleteAllMapsButton=document.getElementById("deleteAllMapsButton")).addEventListener("click",deleteAllMaps)):4===e&&(map.querySelector(".saveMapButton").style.display="none"),mapsCollection.appendChild(t),(deleteMapButton=t.querySelector(".deleteMapButton")).addEventListener("click",deleteMap),document.getElementById("thin"+currentID).onload=function(){highlightSAMmap(lastIndex,"thin"+currentID),t.querySelector(".birdName.smallBirdText").classList.add("highlightName"),mapsCollection.lastChild.style.opacity="1",currentID++}}}function deleteAllMaps(e){e.stopPropagation();for(var t=mapsCollection.getElementsByClassName("thinify smallBird").length,a=1;a<=t;a++)mapsCollection.removeChild(mapsCollection.childNodes[3]);mapsCollection.classList.remove("namesOnlySeen"),mapsCollection.removeEventListener("click",revealMapsCollection),deleteAllMapsButton.removeEventListener("click",deleteAllMaps),mapsCollection.classList.remove("open"),map.classList.remove("shiftUp"),map.querySelector(".saveMapButton").style.display="block"}var sampleTable,leftCheck,sciNames,italics,lineNumbers,showEndemics,currentChecklistCountry,currentChecklistCountryElement,checklistAuthorsPanel,countryModalOverlay,countryModalOpener,countryModal,gNumDays,gStartDate,previousNumDaysClass,numDaysButton,checklistCountryButton,pdfButton,csvButton,taxonomyCountryButton,map;document.addEventListener("DOMContentLoaded",function(){map=document.getElementById("currentMap"),window.addEventListener("resize",onResizeWindow),(countryModalOverlay=document.querySelector(".md-overlay")).addEventListener("click",closeCountryModal),checklistCountryButton=document.getElementById("checklistCountryButton"),taxonomyCountryButton=document.getElementById("taxonomyCountryButton"),checklistCountryButton.addEventListener("click",showCountryModal),taxonomyCountryButton.addEventListener("click",showCountryModal),(numDaysButton=document.getElementById("numDays")).addEventListener("click",setNumDays),numDaysButton.children.item(11).classList.add("highlight"),gNumDays=10,(sampleTable=document.getElementById("sampleTable")).classList.add("numDays"+String(gNumDays)),previousNumDaysClass="numDays"+String(gNumDays),(pdfButton=document.getElementById("pdfButton")).addEventListener("click",openChecklistPage),(csvButton=document.getElementById("csvButton")).addEventListener("click",getCSVText),lineNumbers=document.getElementById("lineNumbers"),leftCheck=document.getElementById("leftCheck"),showEndemics=document.getElementById("showEndemics"),sciNames=document.getElementById("sciNames"),italics=document.getElementById("italics"),previousNumDaysClass="numDays10",lineNumbers.addEventListener("click",toggleSampleTableLineNumbers),leftCheck.addEventListener("click",toggleSampleTableLeftChecks),showEndemics.addEventListener("click",toggleSampleTableShowEndemics),sciNames.addEventListener("click",toggleSampleTableSciNames),italics.addEventListener("click",toggleSampleTableItalics),checklistAuthorsPanel=document.getElementById("checklistAuthorsPanel"),[].forEach.call(document.getElementsByClassName("country-menu")[0].getElementsByTagName("a"),function(e){e.addEventListener("click",choseCountry)}),toggleSampleTableLeftChecks(),leftCheck.checked=!0,countryModal=document.getElementById("countryModal"),window.innerWidth<870&&window.addEventListener("scroll",checkWindowScroll)});var countries={Argentina:0,Aruba:1,Bolivia:2,Brazil:3,Chile:4,Colombia:5,"CuraÃ§ao":6,Ecuador:7,FrenchGuiana:8,Guyana:9,Paraguay:10,Peru:11,Suriname:12,Trinidad:13,Uruguay:14,Venezuela:15,Bonaire:16,Falklands:17},endemicColor="#C23BC3",extinctColor="#f33",residentColor="#00838f",nonBreederColor="#df7900",vagrantColor="gold",hypotheticalColor="#005903",introducedColor="#111",baseColor="â#5e5e5e",baseStrokeColor="#bbb",lastQuery,lastSpecies,species,families,numFamilies,birds=[],numSpeciesList={Argentina:1002,Aruba:219,Bolivia:1381,Brazil:1799,Chile:496,Colombia:1847,"CuraÃ§ao":218,Ecuador:1620,"French Guiana":697,Guyana:783,Paraguay:694,Peru:1792,Suriname:728,Trinidad:468,Uruguay:444,Venezuela:1382,Bonaire:210,Falklands:227,Malvinas:227,"South America":3379},numFamiliesList={Argentina:87,Aruba:52,Bolivia:78,Brazil:91,Chile:66,Colombia:90,"CuraÃ§ao":50,Ecuador:91,"French Guiana":82,Guyana:78,Paraguay:72,Peru:88,Suriname:80,Trinidad:70,Uruguay:72,Venezuela:87,Bonaire:47,Falklands:48,Malvinas:48,"South America":102},currentTaxonomyCountry,currentTaxonomyCountryElement,taxonomyArticle,taxTreeArticleOpen=!1,taxPage,searchSpecials,searchResults,simpleBarResults,simpleBarTaxPage,searchInput,lastResultsSpecies,lastIndex,searchSlideUpWrapper,searchSlideUpWrapper_height,taxInstructionsButton,searchInstructionsOpen=!0,selectedFillColor="#fff";document.addEventListener("DOMContentLoaded",function(){taxonomyArticle=document.getElementById("taxonomyArticle"),(searchSlideUpWrapper=document.querySelector("#taxonomyArticle > div.slideUpWrapper")).style.height=searchSlideUpWrapper.clientHeight+"px",searchSlideUpWrapper_height=searchSlideUpWrapper.style.height,taxInstructionsButton=document.querySelector(".taxInstructionsButton"),searchInput=document.getElementById("searchInput"),searchSpecials=document.getElementById("searchSpecials"),searchInput.addEventListener("input",getQuery),searchInput.addEventListener("change",getQuery),searchInput.addEventListener("click",getQuery),searchInput.addEventListener("textInput",getQuery),searchInput.addEventListener("focusin",getQuery),searchInput.addEventListener("input",clearSearchInput),searchInput.addEventListener("change",clearSearchInput),searchInput.addEventListener("click",clearSearchInput),searchInput.addEventListener("textInput",clearSearchInput),searchInput.addEventListener("keyup",clearSearchInput),searchInput.addEventListener("focusin",clearSearchInput),searchSpecials.addEventListener("click",getSearchSpecialsQuery),taxInstructionsButton.addEventListener("click",showSearchInstructions),taxPage=document.getElementById("taxPage"),(searchResults=document.getElementById("searchResults")).addEventListener("click",gotoMatch),taxPage.addEventListener("click",toggleFamilyOpen),getAjax("../data/occurrences.txt",function(e){loadIntoArray(e)})});var deleteMapButton,saveMapButton,mapsCollection,deleteAllMapsButton,currentID=0;document.addEventListener("DOMContentLoaded",function(){(saveMapButton=document.querySelector(".saveMapButton")).addEventListener("click",saveCurrentMap),mapsCollection=document.getElementById("mapsCollection")});